<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Mini NOC - Network Health Dashboard</title>
  <!-- Simple CSS (Bootstrap CDN for nice look) -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  >
  <meta http-equiv="refresh" content="5"> <!-- 5 sec auto-refresh -->
  <style>
    body {
      background-color: #0b1120;
      color: #e5e7eb;
    }
    .status-up {
      background-color: #14532d;
      color: #bbf7d0;
    }
    .status-down {
      background-color: #7f1d1d;
      color: #fecaca;
    }
    .status-unknown {
      background-color: #374151;
      color: #e5e7eb;
    }
    .card-custom {
      background-color: #111827;
      border-radius: 1rem;
      box-shadow: 0 10px 25px rgba(0,0,0,0.5);
      border: 1px solid #1f2937;
    }
  </style>
</head>
<body class="p-4">
  <div class="container">
    <h1 class="mb-3">Mini NOC - Network Health Dashboard</h1>
    <p class="text-secondary">Last page refresh: {{ generated_at }}</p>

    <div class="card card-custom mt-3">
      <div class="card-body">
        <table class="table table-dark table-hover align-middle mb-0">
       <thead>
  <tr>
    <th scope="col">Device Name</th>
    <th scope="col">IP Address</th>
    <th scope="col">Status</th>
    <th scope="col">Last Change</th>
    <th scope="col">Last Checked</th>
    <th scope="col">SSH</th>
    <th scope="col">Telnet</th>
  </tr>
</thead>
<tbody>
{% if devices %}
  {% for d in devices %}
    {% set cls = "status-unknown" %}
    {% if d.status == "UP" %}
      {% set cls = "status-up" %}
    {% elif d.status == "DOWN" %}
      {% set cls = "status-down" %}
    {% endif %}

    <tr class="{{ cls }}">
      <td>{{ d.name }}</td>
      <td>{{ d.ip }}</td>
      <td><strong>{{ d.status }}</strong></td>
      <td>{{ d.last_change }}</td>
      <td>{{ d.last_checked }}</td>

      <!-- SSH column -->
      <td>
        {% if d.ssh_enabled %}
          <!-- Command text (copy karne ke liye) -->
          <div class="d-flex flex-column">
            <code style="font-size: 0.8rem;">
              ssh {{ d.ssh_user }}@{{ d.ip }} -p {{ d.ssh_port }}
            </code>
            <!-- Optional: ssh:// link (agar system support kare) -->
            <a
              href="ssh://{{ d.ssh_user }}@{{ d.ip }}:{{ d.ssh_port }}"
              class="btn btn-sm btn-outline-light mt-1"
              target="_blank"
            >
              Open SSH
            </a>
          </div>
        {% else %}
          <span class="text-muted">N/A</span>
        {% endif %}
      </td>

      <!-- Telnet column -->
      <td>
        {% if d.telnet_enabled %}
          <div class="d-flex flex-column">
            <code style="font-size: 0.8rem;">
              telnet {{ d.ip }} {{ d.telnet_port }}
            </code>
            <a
              href="telnet://{{ d.ip }}:{{ d.telnet_port }}"
              class="btn btn-sm btn-outline-light mt-1"
              target="_blank"
            >
              Open Telnet
            </a>
          </div>
        {% else %}
          <span class="text-muted">N/A</span>
        {% endif %}
      </td>
    </tr>
  {% endfor %}
{% else %}
  <tr>
    <td colspan="7" class="text-center text-muted">
      No data yet. Wait few seconds for first health cycle.
    </td>
  </tr>
{% endif %}
</tbody>

